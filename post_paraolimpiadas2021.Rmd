---
title: "Olimpiadas"
author: "Ianní"
date: "2023-02-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(ggplot2)

```

Olá, pessoal!

Se você já é um entusiasta de ciência de dados, provavelmente já ouviu falar do TidyTuesday. Se está iniciando, este é um ótimo lugar para conseguir dados reais para praticar e criar um portfolio. O tidytuesday é um projeto semanal do R for Data Science Community, que tem como objetivo ajudar as pessoas a aprender e praticar a análise de dados em R usando o pacote Tidyverse, conheça aqui <https://github.com/rfordatascience/tidytuesday>. 

Cada semana, é lançado um novo conjunto de dados, geralmente em formato de planilha, que pode ser baixado gratuitamente. A comunidade é então convidada a explorar, visualizar e analisar esses dados usando as ferramentas do Tidyverse, como o ggplot2 para gráficos e o dplyr para manipulação de dados. 

Hoje vamos dar uma olhada na base do início de agosto de 2021, quando o TidyTuesday lançou um conjunto de dados fascinante sobre as paraolimpiadas de 2021. O conjunto de dados inclui informações sobre características dos atletas, o país de origem, o tipo de prova, entre outras variáveis. 

Para começar vamos carregar os dados! Lembrando de manter a boa prática de iniciar o script carregando as bibliotecas necessárias, vai ficar comentado aqui (com # na frente, para os avisos não poluirem o post).
```{r intro,warning=FALSE}
#library(tidyverse)
#library(readr)
#library(ggplot2)

dados_olimpiadas <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-08-03/athletes.csv")

```

Antes de começar, outra boa prática é conhecer os dados, quais colunas possui? Como está o preenchimento das variáveis? 
```{r isna}
colSums(is.na(dados_olimpiadas))
```

No tidytuesday os dados costumam vir mais arrumados, porém no mundo real é comum encontrarmos erros no preenchimento, sejam eles sistematicos, onde por exemplo a ferramenta que mede velocidade dos competidores falha e traz valores muito grandes ou negativos, ou poderia ser também alguém que preencheu errado o campo de medalha e colocou por exemplo "metal" ao invés de "prata". No repositório desta base, está descrito o que cada coluna representa, te convido para escrever como lição de casa o código que checa as variáveis categóricas em busca de nomes estranhos que não condizem com o que deveria estar naquela variável. Como incentivo, deixo aqui o check de variáveis numéricas. 

Para não ficar um post massivo, vamos focar em natação.

```{r check_numeric, warning=FALSE}
dados_olimpiadas %>% 
  select_if(.,is.numeric) %>%
  pivot_longer(1:2, names_to = 'variaveis', values_to = 'valor') %>% 
  ggplot(aes(x = valor)) +
  geom_histogram() +
  facet_wrap(~variaveis,scales = 'free')
```


Ao analisar esses dados, podemos responder várias perguntas interessantes. Por exemplo, qual país obteve mais medalhas na natação nos Jogos Olímpicos de 2021? Há alguma diferença significativa na quantidade de medalhas conquistadas entre os atletas homens e mulheres?

```{r medalhas, warning=FALSE}
#gráfico para mostrar medalhas de ouro prata e bronze conquistadas por cada país


paralympic_total <- dados_olimpiadas %>%
  filter(type == "Swimming") %>%
  group_by(abb) %>%
  count() %>%
  arrange(desc(n))

paralympic_byMedal <- dados_olimpiadas %>%
  filter(type == "Swimming") %>%
  group_by(abb, medal) %>%
  count()

paralympic_swimming <- paralympic_byMedal %>%
  left_join(paralympic_total, by = "abb") %>%
  rename(number = n.x, total_medals = n.y)


#garantindo que no plot de top five teremos ordenação de acordo com o país que ganhou mais 
top5 <- paralympic_total$abb[1:5]
tail5 <- paralympic_total$abb[(nrow(paralympic_total)-4):nrow(paralympic_total)] 

table_top5 <- paralympic_swimming %>% 
  filter(abb %in% top5) %>%
  mutate(abb = factor(abb,levels = top5)) 

table_tail5 <- paralympic_swimming %>% 
  filter(abb %in% tail5) %>%
  mutate(abb = factor(abb,levels = tail5)) 


plot2 <- table_top5 %>% 
  ggplot(aes(x = abb, y=number, fill = medal))+
  geom_col()+
  theme_minimal()+
  scale_fill_manual(values = c("#D89581", "#D4AF37", "#C0C0C0"))+
  scale_x_discrete(expand = c(0,0)) +
  labs(x="", y="", fill = "", title = "Swimming medals for top 5 countries")+
  theme(legend.position = "none",
        plot.title.position = "plot", 
        plot.title = element_text(family = "mono", face = "bold", size = 8),
        panel.grid.major.x = element_blank(), 
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank(), 
        axis.text = element_text(family = "mono", face = "bold", size = 8))+
  ggtitle("Medalhas de ouro, prata e bronze conquistada pelos países de melhor desempenho")


plot3 <- table_tail5 %>% 
  ggplot(aes(x = abb, y=number, fill = medal))+
  geom_col()+
  theme_minimal()+
  scale_fill_manual(values = c("#D89581", "#D4AF37", "#C0C0C0"))+
  scale_x_discrete(expand = c(0,0)) +
  labs(x="", y="", fill = "", title = "Swimming medals for top 5 countries")+
  theme(legend.position = "none",
        plot.title.position = "plot", 
        plot.title = element_text(family = "mono", face = "bold", size = 8),
        panel.grid.major.x = element_blank(), 
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank(), 
        axis.text = element_text(family = "mono", face = "bold", size = 8))+
  ggtitle("Medalhas de ouro, prata e bronze conquistada pelos países de pior desempenho")
```


Apesar de algumas alterações que fiz, os créditos deste gráfico de barras são da `Erin`, professora que vocês podem encontrar aqui <https://github.com/efranke22>. Continuando podemos ver a diferença entre a quantidade de medalhas conquistadas entre os atletas homens e mulheres? Para isso, veremos primeiro o histograma de nadadores homens e mulheres por país, em seguida o box plot das medalhas conquistadas por cada um, agrupado também pelo tipo de medalha.

```{r}

```

No Tidytuesday anterior a este, também foi lançada uma base focada nas olimpíadas, verifiquei que alguns atletas existem nas duas bases e taí uma curiosidade que vi pela primeira vez, bases de semana subsequente que podem trazer mais insights juntas. Isso também é algo que no mundo real precisamos fazer bastante, chamamos de enriquecimento de base.

Essa foi uma breve demonstração do quanto o Tidytuesday é interessante e como podemos praticar nossas habilidades em tratamento de dados e análise. Esperamos que este artigo tenha inspirado você a explorar o mundo do TidyTuesday, e colocar a mão na massa no R, usando essa fonte de dados incrível para aprimorar suas habilidades em ciência de dados. Lembre-se que a comunidade tá aqui para te ajudar a alcançar seu objetivo em ciência de dados!

